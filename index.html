<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Checklist 25/07</title>
  <style>
    :root {
      --primary: #800020;    /* Bordeaux classique */
      --secondary: #D47386;  /* Un ton plus clair pour les √©l√©ments secondaires */
      --success: #00b894;
      --danger: #ff7675;
      --bg: #4A0E0E;         /* Fond bordeaux sombre pour faire ressortir les cartes */
      --card: #ffffff;
      --tab-active: #A52A2A; /* Brun-rouge plus clair pour l'onglet actif */
    }

    body, button, input, select, textarea { 
      font-family: Verdana, sans-serif; 
    }

    body { 
      background-color: var(--bg);
      color: #2d3436;
      max-width: 600px;
      margin: auto; 
      padding: 20px;
      font-size: 14px;
    }

	h1 { 
      text-align: center; 
      color: #F5F5F5; /* Pour que √ßa ressorte sur le fond bordeaux */
      font-weight: 600; 
      margin-bottom: 30px;
      font-family: 'Playfair Display', 'Didot', 'Georgia', serif; 
      font-size: 32px;
      letter-spacing: 1px; /* Un l√©ger espacement pour le c√¥t√© √©l√©gant */
      text-transform: uppercase; /* Optionnel : en majuscules pour encore plus de structure */
    }

    #add { 
      background: var(--card);
      padding: 20px;
      border-radius: 0;
      box-shadow: 0 4px 15px rgba(0,0,0,0.05);
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-bottom: 30px;
    }
	
	#add label {
      color: var(--primary); /* Utilise ton bordeaux sur le fond blanc de la carte */
      font-weight: 600;
    }

    input[type="text"] { 
      padding: 12px; 
      border: 1px solid #dfe6e9; 
      border-radius: 0; 
      font-size: 14px;
      outline: none;
      transition: border-color 0.3s;
    }
    
	input[type="text"], select { 
     font-size: 16px; /* √âvite le zoom auto sur iOS */
    }
	
    input[type="text"]:focus { border-color: var(--primary); }

    button#addBtn { 
      background: var(--primary); 
      color: white; 
      border: none; 
      padding: 12px;
      font-family: inherit; /* Pour bien prendre le Verdana */
      font-size: 13px;	  
      border-radius: 0; 
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.2s, background 0.3s;
    }

    button#addBtn:active { transform: scale(0.98); }

    /* Liste des t√¢ches */
    .item { 
      background: var(--card);
      margin-bottom: 12px;
      padding: 15px;
      border-radius: 4px;
      display: flex;
      align-items: center;
      gap: 15px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.03);
      transition: all 0.3s ease;
    }

    .item.done { opacity: 0.6; background: #f1f2f6; }

    /* Grande Case √† cocher personnalis√©e */
    .checkbox-container {
      position: relative;
      width: 30px;
      height: 30px;
      cursor: pointer;
    }

    .checkbox-container input { display: none; }

    .checkmark {
      position: absolute;
      top: 0; left: 0;
      height: 30px; width: 30px;
      background-color: #eee;
      border-radius: 0;
      transition: 0.3s;
      border: 1.5px solid #086972;
    }

    .checkbox-container input:checked ~ .checkmark { background-color: var(--success); }

    .checkmark:after {
      content: "";
      position: absolute;
      display: none;
      left: 10px;
      top: 5px;
      width: 6px;
      height: 12px;
      border: solid white;
      border-width: 0 3px 3px 0;
      transform: rotate(45deg);
    }

    .checkbox-container input:checked ~ .checkmark:after { display: block; }

    /* Infos de la t√¢che */
    .item-content { flex: 1; }
    .item-title { font-weight: 600; display: block; margin-bottom: 4px; font-size: 14px; }
    .item-details { font-size: 12px; color: #636e72; display: flex; gap: 8px; flex-wrap: wrap; }
    .badge { background: #f1f2f6; padding: 2px 8px; border-radius: 4px; }

    .delete-btn { 
      background: none; border: none; color: var(--danger); 
      font-size: 20px; cursor: pointer; padding: 5px;
    }

    /* Couleur pour la Veille */
    .item.veille { border-left: 10px solid #A3B18A; }

    /* Couleur pour le Jour J */
    .item.jourj { border-left: 10px solid #D69B8F; }

    /* On ajuste un peu la carte pour que le bord color√© soit joli */
    .item { border-left: 8px solid transparent; }

    .badge { 
      cursor: pointer; 
      transition: background 0.2s;
      user-select: none; /* √âvite de s√©lectionner le texte en cliquant vite */
    }

    .badge:hover {
      background: #dfe6e9; /* Devient un peu plus fonc√© au survol */
    }

    .tabs { display: flex; gap: 5px; margin-bottom: 20px; width: 100%; }
	
  .tab-btn { 
    flex: 1; padding: 10px 5px; border: none; font-family: inherit; border-radius: 0; 
    background: #dfe6e9; cursor: pointer; font-weight: bold; color: var(--bg); font-size: 11px; text-transform: uppercase;
	white-space: nowrap;display: flex; align-items: center; justify-content: center; gap: 4px;
  }
  .tab-btn.active { background: #A3B18A; color: white !important; }

  .timeline-card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
  .timeline-list { 
    list-style: none; 
    padding: 0; 
    border-left: 2px dashed #dfe6e9; 
    margin-left: 20px; /* On se place juste apr√®s la fin des 60px de l'heure */
    padding-left: 15px; 
  }

  .timeline-list li { 
    display: flex;             /* Aligne l'heure et le texte sur la m√™me ligne */
    align-items: flex-start;   /* Aligne le texte en haut si plusieurs lignes */
    padding: 15px 0; 
    border-bottom: 1px solid #eee; 
  }

  .time { 
    color: var(--primary); 
    font-weight: 800; 
    font-size: 14px;
    width: 55px;               /* Largeur fixe pour la colonne des heures */
    flex-shrink: 0;            /* Emp√™che l'heure de r√©tr√©cir */
  }
  
  .name { 
    color: var(--primary); 
    font-weight: 800; 
    font-size: 14px;
    width: 80px;
    flex-shrink: 0;
	margin-right: 30px;
  }
   .contact-card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
  .contact-list { 
    list-style: none; 
    padding: 0; 
    border-left: none; 
    margin-left: 0;
  }

  .contact-list li { 
    display: flex;
    align-items: flex-start;
    padding: 15px 0; 
    border-bottom: 1px solid #eee; 
  }

  .desc { 
    font-size: 14px; 
    line-height: 1.4;          /* Espace un peu les lignes pour la lecture */
    color: var(--primary);
	font-weight: bold;
  }

  .desc-container {
    display: flex;
    flex-direction: column;
    flex: 1;
  }

  .note {
    font-size: 13px;       /* Plus petit que le texte principal */
    color: #000000;        /* Un gris plus doux */
    margin-top: 4px;       /* Un petit espace avec la ligne du dessus */
  }

  /* Style de la l√©gende */
  .legend-container {
    display: flex;
    gap: 20px;
    justify-content: center;
    margin-bottom: 20px;
    font-size: 14px;
    font-weight: 600;
	color: #F5F5F5;
  }

  .legend-item {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .dot {
    width: 25px;
    height: 25px;
    border-radius: 50%;
	flex-shrink: 0;
  }

  /* Couleurs identiques √† tes bordures d'√©tiquettes */
  .dot.veille { background-color: #A3B18A; }
  .dot.jourj { background-color: #D69B8F; }

  * {
    box-sizing: border-box;
  }

  body {
    overflow-x: hidden; /* Emp√™che le d√©filement horizontal parasite */
  }

  /* Ajoute un petit espace entre le groupe Jour J et le groupe Veille */
  .item.veille + .item.jourj {
    margin-top: 30px;
    position: relative;
  }

  /* Optionnel : ajoute un petit texte s√©parateur "Actions du jour J" */
  .item.veille + .item.jourj::before {
    content: "Actions du jour J";
    position: absolute;
    top: -25px;
    left: 0;
    font-size: 12px;
    font-weight: bold;
    color: #F5F5F5;
    text-transform: uppercase;
  }

  </style>
</head>
<body>

  <h1>Mariage 25/07/26</h1>

  <div class="tabs">
    <button class="tab-btn active" onclick="showTab('checklist')">üìã Checklist</button>
    <button class="tab-btn" onclick="showTab('timeline')">üïí D√©roul√©</button>
    <button class="tab-btn" onclick="showTab('contact')">üë• Contacts</button>
  </div>

  <div id="add">
    <input type="text" id="newItem" placeholder="Action (ex: R√©server le traiteur...)">
    <div style="display: flex; gap: 8px; flex-wrap: wrap;">
      <input type="text" id="newPlace" placeholder="Lieu" style="flex: 1; min-width: 140px;">
      <input type="text" id="newOwner" placeholder="Responsable" style="flex: 1; min-width: 140px;">
    </div>

    <div style="display: flex; justify-content: space-around; padding: 10px; background: #f1f2f6; border-radius: 8px; margin-top: 5px;">
      <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
        <input type="radio" name="moment" value="veille" checked style="transform: scale(1.5);"> Veille
      </label>
      <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
        <input type="radio" name="moment" value="jourj" style="transform: scale(1.5);"> Jour J
      </label>
    </div>

    <button id="addBtn" onclick="addItem()">Ajouter √† la liste</button>
  </div>

  <div style="margin-bottom: 20px;">
  <input type="text" id="filterInput" onkeyup="filterTasks()" placeholder="Rechercher..." 
         style="width: 100%; padding: 10px; border-radius: 4px; border: none; box-sizing: border-box; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
  </div>
  
  <div class="legend-container">
    <div class="legend-item">
      <span class="dot veille"></span> <span>Veille</span>
    </div>
    <div class="legend-item">
      <span class="dot jourj"></span> <span>Jour J</span>
    </div>
  </div>

  <div id="counter-container" style="text-align: center; margin-bottom: 20px; font-weight: bold; color: #F5F5F5 !important;">
    <span id="completed-count">0</span> / <span id="total-count">0</span> actions r√©alis√©es
  </div>

  <div id="list"></div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js";
    import { 
      getDatabase, ref, onValue, push, set, remove, update 
    } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-database.js";

    // TA CONFIGURATION (Gard√©e de ton code pr√©c√©dent)
    const firebaseConfig = {
      apiKey: "AIzaSyCbpc_k-kDC5pN6A2MLmt_6jCJ0mnM_AC4",
      authDomain: "checklist-mariage.firebaseapp.com",
      databaseURL: "https://checklist-mariage-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "checklist-mariage",
      storageBucket: "checklist-mariage.firebasestorage.app",
      messagingSenderId: "436777851923",
      appId: "1:436777851923:web:341755f72d59a6dff9b3e6",
      measurementId: "G-T096M0YK86"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    
    const listDiv = document.getElementById("list");

    function render(items) {
      listDiv.innerHTML = "";
      for (const id in items) {
        const item = items[id];

        const row = document.createElement("div");
        // On ajoute la classe veille ou jourj en fonction de la donn√©e
        row.className = `item ${item.done ? 'done' : ''} ${item.moment || ''}`;

        row.innerHTML = `
          <label class="checkbox-container">
            <input type="checkbox" ${item.done ? 'checked' : ''} onchange="toggleItem('${id}', ${item.done}, '${item.text.replace(/'/g, "\\'")}', '${(item.place || '').replace(/'/g, "\\'")}', '${(item.owner || '').replace(/'/g, "\\'")}', '${item.moment}')">
            <span class="checkmark"></span>
          </label>
          <div class="item-content">
            <span class="item-title" onclick="editField('${id}', 'text', '${item.text.replace(/'/g, "\\'")}')" style="cursor: pointer;">
  ${item.text}
            </span>
            <div class="item-details">
  		<span class="badge" onclick="editField('${id}', 'place', '${item.place || ''}')">
                 üìç ${item.place || ' ? '}
                </span>
                <span class="badge" onclick="editField('${id}', 'owner', '${item.owner || ''}')">
                 üë§ ${item.owner || ' ? '}
  	        </span>
	    </div>
          </div>
          <button class="delete-btn" onclick="deleteItem('${id}', '${item.text}')">&times;</button>
        `;
        listDiv.appendChild(row);
      }
    }

    // Fonctions globales pour Firebase
    window.toggleItem = (id, currentStatus, text, place, owner, moment) => {
      update(ref(db, "items/" + id), {
      text: text,
      place: place,
      owner: owner,
      moment: moment, // <--- On rajoute cette ligne pour ne pas perdre la couleur
      done: !currentStatus
    });
  };

    window.deleteItem = (id, text) => {
      if (confirm(`Supprimer "${text}" ?`)) remove(ref(db, "items/" + id));
    };

    window.addItem = function () {
      const text = document.getElementById("newItem").value.trim();
      if (!text) return;
      const place = document.getElementById("newPlace").value.trim();
      const owner = document.getElementById("newOwner").value.trim();
      const moment = document.querySelector('input[name="moment"]:checked').value;
  
      // On ajoute Date.now() pour avoir le moment pr√©cis de cr√©ation
      push(ref(db, "items"), { 
        text, 
        place, 
        owner, 
        moment, 
        done: false, 
        createdAt: Date.now() 
      });

      // Reset des champs
      document.getElementById("newItem").value = "";
      document.getElementById("newPlace").value = "";
      document.getElementById("newOwner").value = "";
    };

    onValue(ref(db, "items"), snap => {
      const data = snap.val() || {};
      const entries = Object.entries(data);

      // --- PARTIE COMPTEUR ---
      const total = entries.length;
      const completed = entries.filter(item => item[1].done).length;
      if(document.getElementById("total-count")) {
        document.getElementById("total-count").innerText = total;
        document.getElementById("completed-count").innerText = completed;
      }

      // --- LOGIQUE DE TRI (Les faites tout en bas) ---
      const sortedItems = entries.sort((a, b) => {
        const itemA = a[1];
        const itemB = b[1];

        // PRIORIT√â 1 : Le statut "Fait"
        // Si l'un est fait et l'autre non, le fait va en bas (false < true)
        if (itemA.done !== itemB.done) {
          return itemA.done - itemB.done;
        }

        // PRIORIT√â 2 : Le Moment (seulement si le statut 'done' est le m√™me)
        const momentOrder = { 'veille': 1, 'jourj': 2 };
        const orderA = momentOrder[itemA.moment] || 3;
        const orderB = momentOrder[itemB.moment] || 3;
      
        if (orderA !== orderB) {
          return orderA - orderB;
        }

        // PRIORIT√â 3 : Alphab√©tique (pour la stabilit√©)
        return itemA.text.localeCompare(itemB.text);
      });

      render(Object.fromEntries(sortedItems));
    });
  
  window.filterTasks = function() {
    const query = document.getElementById("filterInput").value.toLowerCase();
    const items = document.querySelectorAll(".item");

    items.forEach(item => {
      // On r√©cup√®re tout le texte √† l'int√©rieur de la carte (titre, lieu, responsable)
      const text = item.innerText.toLowerCase();
    
      // Si la recherche est vide ou si le texte contient le mot tap√©, on affiche
      if (text.includes(query)) {
        item.style.display = "flex";
      } else {
        item.style.display = "none"; // Sinon on cache
      }
    });
  };
  window.editField = function(id, field, oldValue) {
    const label = field === 'place' ? 'le lieu' : 'le responsable';
    const newValue = prompt(`Modifier ${label} :`, oldValue);
  
    // Si l'utilisateur clique sur Annuler, on ne fait rien
    if (newValue === null) return; 
  
    // On met √† jour uniquement le champ concern√© dans Firebase
    const itemRef = ref(db, `items/${id}/${field}`);
    set(itemRef, newValue);
  };

  window.showTab = function(tabName) {
    // 1. On d√©finit ce qui doit √™tre visible pour chaque onglet
    const isChecklist = tabName === 'checklist';
    const isTimeline = tabName === 'timeline';
    const isContact = tabName === 'contact';

    // 2. Gestion des sections principales
    document.getElementById('add').style.display = isChecklist ? 'flex' : 'none';
    document.getElementById('filterInput').style.display = isChecklist ? 'block' : 'none';
    document.getElementById('list').style.display = isChecklist ? 'block' : 'none';
    document.querySelector('.legend-container').style.display = isChecklist ? 'flex' : 'none';
    document.getElementById('counter-container').style.display = isChecklist ? 'block' : 'none';

    // 3. Gestion des onglets sp√©cifiques (Timeline vs Contact)
    document.getElementById('timeline-section').style.display = isTimeline ? 'block' : 'none';
    document.getElementById('contact-section').style.display = isContact ? 'block' : 'none';

    // 4. Gestion de l'apparence des boutons (classe active)
    const btns = document.querySelectorAll('.tab-btn');
    btns[0].classList.toggle('active', isChecklist);
    btns[1].classList.toggle('active', isTimeline);
    btns[2].classList.toggle('active', isContact);
  };

  </script>

  <div id="timeline-section" style="display: none;">
    <div class="timeline-card">
      <h3>üïí Planning de la journ√©e</h3>
      <ul class="timeline-list">
        <li>
          <span class="time">13:30</span>
	  <div class="desc-container">
	    <span class="desc"><strong>Coiffure et Maquillage</strong></span>
            <span class="note">üìç Larressingle<br>Pr√©sence de Laetitia, Fanny, Maman, L√©andra</span>
	  </div>
        </li>
        <li>
          <span class="time">15:30</span>
	  <div class="desc-container">
            <span class="desc"><strong>Habillage, arriv√©e des Dem. d'honneur et t√©moins √† la maison</strong></span>
	    <span class="note">üìç Larressingle<br>Photographe pr√©sent pour les derniers pr√©paratifs (√† v√©rifier)</span>
	  </div>
        </li>
        <li>
	  <span class="time">16:00</span>
	  <div class="desc-container">
	    <span class="desc"><strong>C√©r√©monie Civile</strong></span>
 	    <span class="note">üìç Larressingle<br>Distribution d'√©ventails et ombrelles √† l'arriv√©e des invit√©s si n√©cessaire.<br>Arriv√©e de la mari√©e vers 16h15</span>
          </div>
        </li>
        <li>
          <span class="time">17:00</span>
	  <div class="desc-container">
	    <span class="desc"><strong>Photos des mari√©s au ch√¢teau de Larressingle</strong><br>üìû Photographe - David : 06 84 36 67 12</span>
 	    <span class="note">Les invit√©s rejoignent la Palombi√®re d'Henri √† Moncrabeau</span>
          </div>
        </li>
        <li>
          <span class="time">18:00</span>
	  <div class="desc-container">
	    <span class="desc"><strong>C√©r√©monie La√Øque</strong></span>
 	    <span class="note">üìç Palombi√®re d'Henri<br>Animation par Tony, discours des t√©moins et des parents, √©change des alliances et voeux</span>
          </div>
        </li>
        <li>
          <span class="time">18:45</span>
	  <div class="desc-container">
	    <span class="desc"><strong>Vin d'honneur</strong><br>üìû Saxophoniste - Pierre : 07 80 23 94 09</span>
 	    <span class="note">Cocktail & bouch√©es (4 serveurs)<br>Activit√©s : photos de groupe, p√©tanque, mur des invit√©s, polaro√Ød</span>
          </div>
        </li>
        <li>
          <span class="time">21:00</span>
	  <div class="desc-container">
	    <span class="desc"><strong>D√Æner</strong><br>üìû Traiteur - M. Ducousseau : 06 87 12 94 68</span>
 	    <span class="note">Plat + Assiette de fromage<br>Discours plus fun des amis et jeux</span>
          </div>
        </li>
        <li>
          <span class="time">22:30</span>
	  <div class="desc-container">
	    <span class="desc"><strong>Ouverture de bal</strong></span>
 	    <span class="note">Valse papa et Adil<br>Responsable musique : L√©andra</span>
          </div>
        </li>
        <li>
          <span class="time">22:45</span>
	  <div class="desc-container">
	    <span class="desc"><strong>Pi√®ces-mont√©e</strong><br>üìû P√¢tisserie - C. Garnier : 05 62 28 11 33</span>
 	    <span class="note">Livraison par le patissier directement</span>
          </div>
        </li>
        <li>
          <span class="time">23:15</span>
	  <div class="desc-container">
	    <span class="desc"><strong>Soir√©e</strong></span>
 	    <span class="note">Surprise des Dem. d'honneur, Playlist de soir√©e</span>
          </div>
        </li>
      </ul>
    </div>
  </div>
  
  <div id="contact-section" style="display: none;">
    <div class="contact-card">
      <h3>üë• Respo et musique</h3>
      <ul class="contact-list">
        <li>
          <span class="name">Papa</span>
	  <div class="desc-container">
            <span class="desc"><strong>Respo sono et c√¢bles</strong></span>
	    <span class="note">07 48 14 76 75<br>Enceinte et playlist mairie avec Xavier.<br>Mise en place des enceintes au lieu.<br>Micro, rallonges, lumi√®res du soir.</span>
	  </div>
        </li>
        <li>
	  <span class="name">L√©andra</span>
	  <div class="desc-container">
	    <span class="desc"><strong>Respo vid√©o et playlist du soir</strong></span>
 	    <span class="note">06 33 74 73 83<br>Mise en place du tr√©pied avec Go Pro pour la c√©r√©monie la√Øque, pour l'ouverture de bal, et pour la danse.<br>Lancement de la musique pour l'ouverture de bal et pour la danse surprise.</span>
          </div>
        </li>
        <li>
          <span class="name">Ilona</span>
	  <div class="desc-container">
	    <span class="desc"><strong>Respo Go Pro</strong></span>
 	    <span class="note">06 04 16 24 01<br>Chargement de la Go Pro entre la c√©r√©monie la√Øque, l'ouverture de bal, et la soir√©e</span>
          </div>
        </li>
        <li>
          <span class="name">Saban</span>
	  <div class="desc-container">
	    <span class="desc"><strong>Respo Alliances</strong></span>
 	    <span class="note">07 81 79 71 80<br>Apporter les alliances aux mari√©s √† la c√©r√©monie la√Øque</span>
          </div>
        </li>
        <li>
          <span class="name">Karen</span>
	  <div class="desc-container">
	    <span class="desc"><strong>Respo playlist du jour</strong></span>
 	    <span class="note">07 82 29 87 76<br>Playlist c√©r√©monie la√Øque, playlist d√Æner</span>
          </div>
        </li>
        <li>
          <span class="name">Demoiselles d'honneur</span>
	  <div class="desc-container">
	    <span class="desc"><strong>Respo timing</strong></span>
 	    <span class="note">Guider les invit√©s apr√®s la mairie vers le Lieu de r√©ception.<br>Inciter les invit√©s √† passer √† table pour le d√Æner<br>Apporter le g√¢teau apr√®s l'ouverture de bal</span>
          </div>
        </li>
		<li>
          <span class="name">Tony</span>
	  <div class="desc-container">
	    <span class="desc"><strong>Animateur c√©r√©monie la√Øque</strong></span>
 	    <span class="note">06 80 16 97 51<br>Texte pr√©par√© √† l'avance.<br>Annonce du vin d'honneur et du d√Æner qui suit.</span>
          </div>
        </li>
      </ul>
    </div>
  </div>

</body>
</html>